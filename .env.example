# =============================================================================
# Slack Server Monitor - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values.
# NEVER commit .env to version control.
# =============================================================================

# =============================================================================
# Slack Configuration (Required)
# =============================================================================

# Bot User OAuth Token from OAuth & Permissions page
# Starts with xoxb-
# Required scopes: commands, chat:write
SLACK_BOT_TOKEN=xoxb-your-bot-token-here

# App-Level Token from Basic Information > App-Level Tokens
# Starts with xapp-
# Required scope: connections:write
SLACK_APP_TOKEN=xapp-your-app-token-here

# =============================================================================
# Authorization (Required)
# =============================================================================

# Comma-separated list of Slack user IDs allowed to run commands
# Find your ID: Click your profile in Slack > More > Copy member ID
# Example: U01ABC123,U02DEF456
AUTHORIZED_USER_IDS=

# Optional: Comma-separated list of channel IDs where commands are allowed
# Leave empty to allow commands from any channel (DMs still work)
# Example: C01ABC123,C02DEF456
AUTHORIZED_CHANNEL_IDS=

# =============================================================================
# Rate Limiting
# =============================================================================

# Maximum commands per user within the rate limit window
RATE_LIMIT_MAX=10

# Rate limit window in seconds
RATE_LIMIT_WINDOW_SECONDS=60

# =============================================================================
# Server Monitoring
# =============================================================================

# Comma-separated container names or prefixes to monitor
# Example: wordpress,nginx,mysql,n8n,suitecrm
MONITORED_SERVICES=

# Comma-separated domains for SSL certificate expiry checks
# Example: example.com,app.example.com,api.example.com
SSL_DOMAINS=

# Maximum log lines to return (hard cap: 500 for security)
MAX_LOG_LINES=50

# Comma-separated backup directories to monitor
# Example: /backups/n8n,/backups/wordpress
BACKUP_DIRS=

# S3 bucket name for backup verification (optional)
S3_BACKUP_BUCKET=

# =============================================================================
# Logging
# =============================================================================

# Log level: debug, info, warn, error
LOG_LEVEL=info

# Path for audit log file (optional, logs to console if not set)
# Example: /var/log/slack-monitor/audit.log
AUDIT_LOG_PATH=

# =============================================================================
# Claude AI Integration (Optional)
# =============================================================================

# Enable Claude AI /ask command
# Set to "true" to enable
CLAUDE_ENABLED=false

# Provider selection (default: cli)
# cli: Use Claude CLI (requires claude command installed)
# Legacy values auto/sdk accepted for backward compatibility
CLAUDE_PROVIDER=cli

# Path to Claude CLI executable (default: claude)
CLAUDE_CLI_PATH=claude

# Model alias for CLI backend (default: sonnet)
# Options: sonnet, opus, haiku
CLAUDE_CLI_MODEL=sonnet

# Maximum tokens for Claude response (default: 2048)
CLAUDE_MAX_TOKENS=2048

# Maximum tool calls per conversation turn (default: 40)
CLAUDE_MAX_TOOL_CALLS=40

# Maximum agentic loop iterations (default: 50, defense in depth)
CLAUDE_MAX_ITERATIONS=50

# Rate limiting for /ask command (per user)
CLAUDE_RATE_LIMIT_MAX=5
CLAUDE_RATE_LIMIT_WINDOW_SECONDS=60

# How long to keep conversation history in hours (default: 24)
CLAUDE_CONVERSATION_TTL_HOURS=24

# SQLite database path for conversation storage
CLAUDE_DB_PATH=./data/claude.db

# Directories Claude is allowed to read files from (comma-separated)
# Example: /root/ansible,/opt/stacks,/etc/docker
CLAUDE_ALLOWED_DIRS=

# Maximum file size Claude can read in KB (default: 100)
CLAUDE_MAX_FILE_SIZE_KB=100

# Maximum log lines Claude can request (default: 50, max: 100)
CLAUDE_MAX_LOG_LINES=50

# Context directory for Claude to read CLAUDE.md and .claude/context/ files
# This directory is automatically added to CLAUDE_ALLOWED_DIRS
# SECURITY NOTE: Claude gains read access to all files in this directory!
# Use a dedicated directory, not /home/user or other general paths.
# Cannot be under system paths: /etc, /var, /usr, /bin, /sbin, /lib, /sys, /proc, /dev
# Example: /opt/infrastructure
CLAUDE_CONTEXT_DIR=

# Multiple context directories that can be switched per-channel using /context command
# Format: alias:path,alias:path
# Aliases must be alphanumeric with underscores/hyphens (no spaces or colons)
# All paths are validated at startup and added to allowed dirs when selected
# Example: homelab:/opt/homelab,infra:/opt/infrastructure,ansible:/root/ansible
CLAUDE_CONTEXT_OPTIONS=

# =============================================================================
# Web Server (Optional - hosts long Claude responses)
# =============================================================================

# Enable web server to host Claude responses that exceed Slack's text limit
# When enabled, long responses will show a link instead of truncating
# Set to "true" to enable
WEB_ENABLED=false

# HTTP port for the web server (default: 8080)
WEB_PORT=8080

# Base URL for links posted to Slack
# This should be accessible from your network (use your server's hostname/IP)
# Example: http://nautilus.local:8080 or http://192.168.1.100:8080
WEB_BASE_URL=

# Admin authentication token (required, min 16 characters)
# Generate with: openssl rand -hex 16
# Used as fallback for users without per-user tokens
# SECURITY: Anyone with this token gets admin-level access to conversation history!
WEB_AUTH_TOKEN=

# Per-user authentication tokens (optional)
# Format: SlackUserId:token,SlackUserId:token
# Each token must be at least 16 characters; user IDs must be Slack format (U...)
# Generate tokens with: openssl rand -hex 16
# When configured, Slack links use the user's token instead of the admin token
# Example: U01ABC123:abcdef0123456789,U02DEF456:9876543210fedcba
WEB_USER_TOKENS=

# Session lifetime in hours (default: 72)
# After clicking a link or logging in, the session cookie lasts this long
# Expired sessions are cleaned up automatically every hour
WEB_SESSION_TTL_HOURS=72

# =============================================================================
# System Paths (Advanced - usually don't need to change)
# =============================================================================

# Docker socket path
DOCKER_SOCKET=/var/run/docker.sock
